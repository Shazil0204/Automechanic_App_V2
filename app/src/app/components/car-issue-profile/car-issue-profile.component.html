<body>

    @if (loading) {
    <div class="overlay">
        <mat-spinner></mat-spinner>
    </div>
    }
    @else {
    <div class="container">
        <div class="car-detail-section">
            <div class="car-detail">
                <mat-form-field appearance="outline">
                    <mat-label>Make</mat-label>
                    <input matInput readonly="true" [value]="issue?.car?.make">
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>Model</mat-label>
                    <input matInput readonly="true" [value]="issue?.car?.model">
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>License Plate</mat-label>
                    <input matInput readonly="true" [value]="issue?.car?.plate">
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>VIN Number</mat-label>
                    <input matInput readonly [value]="issue?.car?.vinNumber">
                </mat-form-field>
            </div>
            <div class="car-detail">
            </div>
        </div>

        <div class="video-section">
            <h2>Video(s)</h2>
            @if (!loadingVideo) {
            @if (videoNotFound) {
            Not Found.
            <app-video-capture [issueId]="issue?.id" (uploadStatus)="handleVideoUpload($event)"></app-video-capture>
            }
            @else {
            <div class="videos">
                <div *ngIf="videos.length <= 0">Loading...<br><mat-spinner></mat-spinner></div>
                @for (item of videos; track $index) {
                <video #videoPlayer [src]="item" width="250" controls></video>
                }
            </div>
            }
            }
        </div>

        <div class="issue-detail-section">
            <h2>Details</h2>
            <div class="issue-detail">
                <mat-form-field class="small-field" appearance="outline">
                    <mat-label>Category</mat-label>
                    <input matInput readonly [value]="issue?.category?.tag">
                </mat-form-field>
                <mat-form-field class="small-field" appearance="outline">
                    <mat-label>Price</mat-label>
                    <input matInput readonly [value]="issue?.price">
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>Creation Date</mat-label>
                    <input matInput readonly [value]="issue?.creationTime | date:'dd/MM/yyyy HH:mm'">
                </mat-form-field>
            </div>
            <div class="issue-detail">
                <mat-form-field appearance="outline">
                    <mat-label>Description</mat-label>
                    <textarea matInput readonly [value]="issue?.description"></textarea>
                </mat-form-field>
            </div>
        </div>
        <div class="button-section">
            <button [routerLink]="'/cars'" routerLinkActive="router-link-active" class="action-button">GÃ¥
                Back</button>
            <button class="action-button">Mark as completed</button>
        </div>
    </div>
    }
</body>